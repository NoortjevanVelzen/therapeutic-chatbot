{"ast":null,"code":"// src/components/ChatbotScreen.js\nimport React,{useState}from\"react\";import axios from\"axios\";import styles from\"./ChatbotScreen.module.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=\"http://localhost:5000\";function ChatbotScreen(_ref){let{onFinish}=_ref;const[messages,setMessages]=useState([{role:\"assistant\",content:\"I’ll adjust your feed to match: soothing content to help you relax, inspiring stories and light news when you're feeling neutral, and joyful posts that celebrate your happiness.\"},{role:\"assistant\",content:\"So, tell me, how you're feeling?\"}]);const[input,setInput]=useState(\"\");const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const userMessages=messages.filter(msg=>msg.role===\"user\");const canFinish=userMessages.length>0;const sendMessage=async()=>{if(!input.trim())return;setError(null);const newMessages=[...messages,{role:\"user\",content:input}];setMessages(newMessages);setInput(\"\");setLoading(true);try{const response=await axios.post(\"\".concat(BACKEND_URL,\"/api/chat\"),{messages:newMessages});setMessages([...newMessages,{role:\"assistant\",content:response.data.reply}]);}catch(e){var _e$response,_e$response$data;setMessages([...newMessages,{role:\"assistant\",content:\"Sorry, there was a problem. Please try again.\"}]);setError(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||\"Server error\");}setLoading(false);};const handleFinish=async()=>{setLoading(true);setError(null);if(!canFinish){onFinish(\"neutral\");setLoading(false);return;}try{var _response$data$mood;const response=await axios.post(\"\".concat(BACKEND_URL,\"/api/mood\"),{userMessages});const backendMood=((_response$data$mood=response.data.mood)===null||_response$data$mood===void 0?void 0:_response$data$mood.toLowerCase())||\"neutral\";onFinish(backendMood);}catch(e){var _e$response2,_e$response2$data;setError(((_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.error)||\"Server error\");onFinish(\"neutral\");}setLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.introBox,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.introTitle,children:\"Welcome to your Therapeutic Chatbot\"}),/*#__PURE__*/_jsx(\"p\",{className:styles.introText,children:\"This chatbot helps you reflect on how you're feeling and tailors your social media feed to support your emotional wellbeing. Just start typing your thoughts, and when you're ready, click to finish and receive your personalized wellbeing feed.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.chatBox,children:[messages.map((msg,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.message,\" \").concat(msg.role===\"user\"?styles.user:styles.assistant),children:[msg.role===\"assistant\"&&/*#__PURE__*/_jsx(\"img\",{src:\"/chatbot-avatar.png\",alt:\"Chatbot\",className:styles.avatarSmall}),/*#__PURE__*/_jsx(\"span\",{className:styles.bubble,children:msg.content})]},idx)),/*#__PURE__*/_jsxs(\"div\",{className:styles.inputContainer,children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>e.key===\"Enter\"&&sendMessage(),className:styles.inputField,placeholder:\"Type your feeling...\",disabled:loading}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,className:styles.sendButton,disabled:loading||!input.trim(),children:\"Send\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleFinish,className:styles.finishButton,disabled:loading||!canFinish,children:loading?\"Analyzing mood...\":\"Create My Wellbeing Feed\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:styles.error,children:error})]})]});}export default ChatbotScreen;","map":{"version":3,"names":["React","useState","axios","styles","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","ChatbotScreen","_ref","onFinish","messages","setMessages","role","content","input","setInput","loading","setLoading","error","setError","userMessages","filter","msg","canFinish","length","sendMessage","trim","newMessages","response","post","concat","data","reply","e","_e$response","_e$response$data","handleFinish","_response$data$mood","backendMood","mood","toLowerCase","_e$response2","_e$response2$data","className","container","children","introBox","introTitle","introText","chatBox","map","idx","message","user","assistant","src","alt","avatarSmall","bubble","inputContainer","value","onChange","target","onKeyDown","key","inputField","placeholder","disabled","onClick","sendButton","finishButton"],"sources":["C:/Users/20184080/OneDrive - TU Eindhoven/Documents/2. Industrial Design/Final Master Project/therapeutic-chatbot/frontend/src/components/ChatbotScreen.js"],"sourcesContent":["// src/components/ChatbotScreen.js\r\n\r\nimport React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport styles from \"./ChatbotScreen.module.css\";\r\n\r\nconst BACKEND_URL = \"http://localhost:5000\";\r\n\r\nfunction ChatbotScreen({ onFinish }) {\r\n  const [messages, setMessages] = useState([\r\n    {\r\n      role: \"assistant\",\r\n      content:\r\n        \"I’ll adjust your feed to match: soothing content to help you relax, inspiring stories and light news when you're feeling neutral, and joyful posts that celebrate your happiness.\",\r\n    },\r\n    {\r\n      role: \"assistant\",\r\n      content: \"So, tell me, how you're feeling?\",\r\n    },\r\n  ]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const userMessages = messages.filter((msg) => msg.role === \"user\");\r\n  const canFinish = userMessages.length > 0;\r\n\r\n  const sendMessage = async () => {\r\n    if (!input.trim()) return;\r\n    setError(null);\r\n    const newMessages = [...messages, { role: \"user\", content: input }];\r\n    setMessages(newMessages);\r\n    setInput(\"\");\r\n    setLoading(true);\r\n\r\n    try {\r\n      const response = await axios.post(`${BACKEND_URL}/api/chat`, {\r\n        messages: newMessages,\r\n      });\r\n      setMessages([\r\n        ...newMessages,\r\n        { role: \"assistant\", content: response.data.reply },\r\n      ]);\r\n    } catch (e) {\r\n      setMessages([\r\n        ...newMessages,\r\n        {\r\n          role: \"assistant\",\r\n          content: \"Sorry, there was a problem. Please try again.\",\r\n        },\r\n      ]);\r\n      setError(e.response?.data?.error || \"Server error\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleFinish = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    if (!canFinish) {\r\n      onFinish(\"neutral\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(`${BACKEND_URL}/api/mood`, {\r\n        userMessages,\r\n      });\r\n      const backendMood = response.data.mood?.toLowerCase() || \"neutral\";\r\n      onFinish(backendMood);\r\n    } catch (e) {\r\n      setError(e.response?.data?.error || \"Server error\");\r\n      onFinish(\"neutral\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      <div className={styles.introBox}>\r\n        <h2 className={styles.introTitle}>Welcome to your Therapeutic Chatbot</h2>\r\n        <p className={styles.introText}>\r\n          This chatbot helps you reflect on how you're feeling and tailors your social media feed to support your emotional wellbeing. Just start typing your thoughts, and when you're ready, click to finish and receive your personalized wellbeing feed.\r\n        </p>\r\n      </div>\r\n\r\n      <div className={styles.chatBox}>\r\n        {messages.map((msg, idx) => (\r\n          <div\r\n            key={idx}\r\n            className={`${styles.message} ${msg.role === \"user\" ? styles.user : styles.assistant}`}\r\n        >\r\n            {msg.role === \"assistant\" && (\r\n              <img\r\n                src=\"/chatbot-avatar.png\"\r\n                alt=\"Chatbot\"\r\n                className={styles.avatarSmall}\r\n              />\r\n            )}\r\n            <span className={styles.bubble}>{msg.content}</span>\r\n          </div>\r\n    ))}\r\n\r\n        <div className={styles.inputContainer}>\r\n          <input\r\n            value={input}\r\n            onChange={(e) => setInput(e.target.value)}\r\n            onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n            className={styles.inputField}\r\n            placeholder=\"Type your feeling...\"\r\n            disabled={loading}\r\n          />\r\n          <button\r\n            onClick={sendMessage}\r\n            className={styles.sendButton}\r\n            disabled={loading || !input.trim()}\r\n          >\r\n            Send\r\n          </button>\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleFinish}\r\n          className={styles.finishButton}\r\n          disabled={loading || !canFinish}\r\n        >\r\n          {loading ? \"Analyzing mood...\" : \"Create My Wellbeing Feed\"}\r\n        </button>\r\n\r\n        {error && <div className={styles.error}>{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatbotScreen;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}